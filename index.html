<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <title>加速度センサー</title>
</head> 
<body>
  <div id="txt">表示</div>

  
  <script>
  let aX = 0, ay = 0, aZ = 0;
  let timer = window.setInterval(() => {
      displayDate();
  }, 1000);


  function post_function( result_string ) {
      if ( result_string === "granted" ) {
          // ユーザが許可した場合、文字列"granted"が返る
      }
      else if ( result_string === "denied" ) {
  // ユーザが拒否した場合、文字列"denied"が返る
      }
  }
  function permission_request() {
      if ( DeviceOrientationEvent
          && DeviceOrientationEvent.requestPermission
          && typeof DeviceOrientationEvent.requestPermission === 'function'
      ) {
  DeviceMotionEvent.requestPermission().then( post_function );
  window.addEventListener( "devicemotion", function(e) {
        aX = e.accelerationIncludingGravity.x;
        aY = e.accelerationIncludingGravity.y;
        aZ = e.accelerationIncludingGravity.z;
          }, false );
      }
      if ( DeviceOrientationEvent
          && DeviceOrientationEvent.requestPermission
          && typeof DeviceOrientationEvent.requestPermission === 'function'
      ) {
          DeviceOrientationEvent.requestPermission().then( postf_unction );
  window.addEventListener( "deviceorientation", function(e) {
              // 何らかの処理
          }, false );
      }
  }
  function displayDate() {
      let txt = document.getElementById("txt");
      txt.innerHTML = "x:" + aX + "<br>"
                    + "y:" + aY + "<br>"
                    + "z:" + aZ;

  }
  </script>
  <button onclick="permission_request();">動作と方向へのアクセス許可</button>
</body>
</html>